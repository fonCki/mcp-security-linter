# MCP Security Linter

Static analysis tool for Model Context Protocol (MCP) repository security vulnerabilities.

## Features

### Currently Implemented:
- **AI-Generated Content Detection** âœ…
  - Detects: ChatGPT, OpenAI, Claude, Anthropic, GPT-3/4, Copilot, Gemini, Bard
  - Automatically skips test files (*.test.js, *.spec.js)
  - Ignores test fixtures and node_modules
  - Configurable severity levels (warning/error/info)

### Planned Analyzers:
- Command injection detection (stub)
- Token passthrough detection (stub)
- Unauthenticated endpoints detection (stub)
- OAuth hygiene checker (stub)
- Argument validation (stub)

## Installation

### As a GitHub Action (Recommended)

#### Step 1: Create the workflow directory

In your repository, create the directory structure (if it doesn't exist):

```bash
mkdir -p .github/workflows
```

#### Step 2: Create a workflow file

Create a new file `.github/workflows/mcp-security.yml` (you can name it anything ending in `.yml`):

```yaml
name: MCP Security Check

on: [push, pull_request]

jobs:
  security-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: fonCki/mcp-security-linter@master
        with:
          path: '.'
          fail-on-warnings: true
```

#### Step 3: Commit and push

```bash
git add .github/workflows/mcp-security.yml
git commit -m "Add MCP security linter workflow"
git push
```

The action will now run automatically on every push and pull request!

### Local Development

Clone the repository and install dependencies:

```bash
git clone https://github.com/fonCki/mcp-security-linter.git
cd mcp-security-linter
npm install
```

## Usage

### CLI

```bash
# From the project directory
node src/cli.js                           # Analyze current directory
node src/cli.js src/                      # Analyze specific path
node src/cli.js --format sarif --output results.sarif  # SARIF output
node src/cli.js --config .mcp-lint.json   # Use custom config
```

### Using in Other Projects

Until published to npm, you can use it via:

```bash
# Option 1: Use as GitHub Action (see above)

# Option 2: Clone and run locally
git clone https://github.com/fonCki/mcp-security-linter.git
cd mcp-security-linter
npm install
node src/cli.js /path/to/your/project
```

### Configuration

Create `.mcp-lint.json` (optional):

```json
{
  "ai-detector": {
    "enabled": true,
    "severity": "warning"
  },
  "command-injection": {
    "enabled": false,
    "severity": "error"
  },
  "token-passthrough": {
    "enabled": false,
    "severity": "error"
  }
}
```

**Configuration Options:**
- `enabled`: Enable/disable the analyzer (default: true for ai-detector, false for stubs)
- `severity`: Set severity level: "error", "warning", or "info" (default: "warning")

**Note:** Only `ai-detector` is currently implemented. Other analyzers are placeholders for future development.

## How It Works

The AI detector scans your source code for mentions of common AI tools and assistants:

**Detected Patterns:**
- ChatGPT, OpenAI, Claude, Anthropic
- GPT-3, GPT-4
- GitHub Copilot, Gemini, Bard
- "Generated by AI" phrases

**Automatically Excluded:**
- Test files (*.test.js, *.spec.js, __tests__/)
- Test fixtures (tests/fixtures/, test/fixtures/)
- node_modules/, dist/, .git/

## Development

```bash
# Install dependencies
npm install

# Run tests
npm test

# Run tests with coverage
npm run test:coverage
```

## Team

This project is developed as part of DTU Course 02234 - Research Topics in Cybersecurity.

For detailed team information, contributions, and contact details, see [TEAM.md](TEAM.md).

**Team Members:**
- Melissa Safari (s224818)
- Zachary Kang (s251598)
- Alfonso Pedro Ridao (s243942)

## License

MIT - See [LICENSE](LICENSE) file for details
